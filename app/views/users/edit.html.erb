<div class="page-header">
  <h1 class="header-title"><%= t('users.edit_profile') %></h1>
  <div class="header-actions">
    <%= link_to t('common.cancel'), profile_path, class: "btn btn-outline" %>
  </div>
</div>

<div class="row">
  <div class="col-md-12">
    <div class="card">
      <div class="card-body">
        <%= form_with(model: @user, url: profile_path, method: :patch, local: true, html: { class: "form-container", multipart: true }) do |form| %>
          <% if @user.errors.any? %>
            <div class="alert alert-danger">
              <h2><%= pluralize(@user.errors.count, "error") %> <%= t('common.form_error') %>:</h2>
              <ul>
                <% @user.errors.full_messages.each do |message| %>
                  <li><%= message %></li>
                <% end %>
              </ul>
            </div>
          <% end %>

          <div class="row">
            <div class="col-md-4">
              <div class="mb-4 text-center">
                <% if @user.profile_image.attached? %>
                  <%= image_tag @user.profile_image.variant(resize_to_limit: [200, 200]), class: "rounded-circle img-fluid mb-3", style: "width: 150px; height: 150px; object-fit: cover;" %>
                <% else %>
                  <div class="profile-placeholder rounded-circle mb-3 mx-auto d-flex align-items-center justify-content-center" style="width: 150px; height: 150px; background-color: #e9ecef;">
                    <span style="font-size: 64px; color: #6c757d;"><%= @user.name.first.upcase %></span>
                  </div>
                <% end %>
                
                <div class="mb-3">
                  <%= form.label :profile_image, t('users.profile_image'), class: "form-label" %>
                  <%= form.file_field :profile_image, class: "form-control", accept: "image/*" %>
                </div>
              </div>
            </div>

            <div class="col-md-8">
              <h4 class="mb-4"><%= t('users.personal_info') %></h4>
                
              <div class="row mb-3">
                <div class="col-md-6">
                  <%= form.label :name, t('users.name'), class: "form-label" %>
                  <%= form.text_field :name, class: "form-control", required: true %>
                </div>
                
                <div class="col-md-6">
                  <%= form.label :email, t('users.email'), class: "form-label" %>
                  <%= form.email_field :email, class: "form-control", required: true %>
                </div>
              </div>
              
              <div class="row mb-3">
                <div class="col-md-6">
                  <%= form.label :phone, t('users.phone'), class: "form-label" %>
                  <%= form.telephone_field :phone, class: "form-control" %>
                </div>
                
                <div class="col-md-6">
                  <%= form.label :id_number, t('users.id_number'), class: "form-label" %>
                  <%= form.text_field :id_number, class: "form-control" %>
                </div>
              </div>
              
              <div class="row mb-3">
                <div class="col-md-6">
                  <%= form.label :gender, t('users.gender'), class: "form-label" %>
                  <%= form.select :gender, User::GENDERS.map { |g| [t("users.genders.#{g}"), g] }, 
                                { include_blank: true }, { class: "form-select" } %>
                </div>
                
                <div class="col-md-6">
                  <%= form.label :date_of_birth, t('users.date_of_birth'), class: "form-label" %>
                  <%= form.date_field :date_of_birth, class: "form-control" %>
                </div>
              </div>
              
              <div class="mb-3">
                <%= form.label :address, t('users.address'), class: "form-label" %>
                <%= form.text_area :address, class: "form-control", rows: 3 %>
              </div>
              
              <h4 class="mt-4 mb-3"><%= t('users.change_password') %></h4>
              <p class="text-muted mb-3"><%= t('users.password_instructions') %></p>
              
              <div class="row mb-3">
                <div class="col-md-6">
                  <%= form.label :password, t('users.new_password'), class: "form-label" %>
                  <%= form.password_field :password, class: "form-control" %>
                </div>
                
                <div class="col-md-6">
                  <%= form.label :password_confirmation, t('users.password_confirmation'), class: "form-label" %>
                  <%= form.password_field :password_confirmation, class: "form-control" %>
                </div>
              </div>
              
              <div class="mt-4">
                <%= form.submit t('common.save'), class: "btn btn-primary" %>
              </div>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>