<div class="page-header">
  <h1 class="header-title"><%= t('rooms.details') %>: <%= @room.number %></h1>
  <div class="header-actions">
    <%= link_to t('common.edit'), edit_room_path(@room), class: "btn btn-outline" %>
    <%= link_to t('common.back'), rooms_path, class: "btn btn-outline" %>
  </div>
</div>

<div class="row">
  <div class="col-md-8">
    <div class="card">
      <div class="card-header">
        <h2 class="card-title"><%= t('rooms.details') %></h2>
      </div>
      <div class="card-body">
        <div class="detail-grid">
          <div class="detail-item">
            <div class="detail-label"><%= t('rooms.number') %></div>
            <div class="detail-value"><%= @room.number %></div>
          </div>
          
          <div class="detail-item">
            <div class="detail-label"><%= t('rooms.floor') %></div>
            <div class="detail-value"><%= @room.floor %></div>
          </div>
          
          <div class="detail-item">
            <div class="detail-label"><%= t('rooms.area') %></div>
            <div class="detail-value"><%= @room.area %> m²</div>
          </div>
          
          <div class="detail-item">
            <div class="detail-label"><%= t('rooms.monthly_rent') %></div>
            <div class="detail-value"><%= number_to_currency(@room.monthly_rent, precision: 0, delimiter: ',', unit: 'VND ') %></div>
          </div>
          
          <div class="detail-item">
            <div class="detail-label"><%= t('common.status') %></div>
            <div class="detail-value">
              <span class="status-badge status-<%= @room.status %>">
                <%= t("rooms.#{@room.status}") %>
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <% if @latest_reading %>
      <div class="card mt-4">
        <div class="card-header">
          <h2 class="card-title"><%= t('utility_readings.latest_readings') %></h2>
        </div>
        <div class="card-body">
          <div class="detail-grid">
            <div class="detail-item">
              <div class="detail-label"><%= t('utility_readings.reading_date') %></div>
              <div class="detail-value"><%= l(@latest_reading.reading_date, format: :long) %></div>
            </div>
            
            <div class="detail-item">
              <div class="detail-label"><%= t('utility_readings.electricity_reading') %></div>
              <div class="detail-value"><%= @latest_reading.electricity_reading %> kWh</div>
            </div>
            
            <div class="detail-item">
              <div class="detail-label"><%= t('utility_readings.water_reading') %></div>
              <div class="detail-value"><%= @latest_reading.water_reading %> m³</div>
            </div>
          </div>
          
          <div class="card-actions">
            <%= link_to t('utility_readings.title'), utility_readings_path(room_id: @room.id), class: "btn btn-sm btn-outline" %>
            <%= link_to t('utility_readings.new'), new_utility_reading_path(room_id: @room.id), class: "btn btn-sm btn-outline" %>
          </div>
        </div>
      </div>
    <% end %>
  </div>
  
  <div class="col-md-4">
    <div class="card">
      <div class="card-header">
        <h2 class="card-title"><%= t('tenants.current_tenant') %></h2>
      </div>
      <div class="card-body">
        <% if @current_tenant %>
          <div class="tenant-info">
            <h3 class="tenant-name"><%= @current_tenant.name %></h3>
            
            <div class="detail-item">
              <div class="detail-label"><%= t('tenants.phone') %></div>
              <div class="detail-value"><%= @current_tenant.phone %></div>
            </div>
            
            <div class="detail-item">
              <div class="detail-label"><%= t('tenants.email') %></div>
              <div class="detail-value"><%= @current_tenant.email %></div>
            </div>
            
            <div class="detail-item">
              <div class="detail-label"><%= t('tenants.move_in_date') %></div>
              <div class="detail-value"><%= l(@current_tenant.move_in_date, format: :long) %></div>
            </div>
            
            <div class="card-actions">
              <%= link_to t('common.view'), tenant_path(@current_tenant), class: "btn btn-sm btn-outline" %>
            </div>
          </div>
        <% else %>
          <div class="empty-state">
            <p><%= t('rooms.no_tenant') %></p>
            <%= link_to t('room_assignments.new'), new_room_assignment_path(room_id: @room.id), class: "btn btn-primary" %>
          </div>
        <% end %>
      </div>
    </div>
    
    <% if @current_tenant %>
      <div class="card mt-4">
        <div class="card-header">
          <h2 class="card-title"><%= t('room_assignments.details') %></h2>
        </div>
        <div class="card-body">
          <% assignment = @room.current_assignment %>
          <% if assignment %>
            <div class="detail-item">
              <div class="detail-label"><%= t('room_assignments.start_date') %></div>
              <div class="detail-value"><%= l(assignment.start_date, format: :long) %></div>
            </div>
            
            <div class="detail-item">
              <div class="detail-label"><%= t('room_assignments.end_date') %></div>
              <div class="detail-value">
                <%= assignment.end_date ? l(assignment.end_date, format: :long) : t('common.none') %>
              </div>
            </div>
            
            <div class="detail-item">
              <div class="detail-label"><%= t('room_assignments.deposit_amount') %></div>
              <div class="detail-value">
                <%= number_to_currency(assignment.deposit_amount, precision: 0, delimiter: ',', unit: 'VND ') %>
              </div>
            </div>
            
            <div class="card-actions">
              <%= link_to t('common.view'), room_assignment_path(assignment), class: "btn btn-sm btn-outline" %>
              <%= link_to t('room_assignments.end'), room_assignment_path(assignment), 
                  method: :delete, 
                  data: { confirm: t('room_assignments.confirm_end') }, 
                  class: "btn btn-sm btn-danger" %>
            </div>
          <% else %>
            <div class="empty-state">
              <p><%= t('room_assignments.no_active') %></p>
            </div>
          <% end %>
        </div>
      </div>
    <% end %>
  </div>
</div>
